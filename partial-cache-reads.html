<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-24T15:38:08.818410003"><title>Partial cache reads | apollo-kotlin-normalized-cache</title><script type="application/json" id="virtual-toc-data">[{"id":"with-apollostore","level":0,"title":"With ApolloStore","anchor":"#with-apollostore"},{"id":"with-apolloclient","level":0,"title":"With ApolloClient","anchor":"#with-apolloclient"},{"id":"error-stored-in-the-cache","level":0,"title":"Error stored in the cache","anchor":"#error-stored-in-the-cache"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b575/app.css" rel="stylesheet"><link href="static/custom.css" rel="stylesheet"><link rel="icon" type="image/png" sizes="16x16" href="images/favicon-96x96.png"><link rel="icon" type="image/png" sizes="32x32" href="images/favicon-192x192.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Partial cache reads | apollo-kotlin-normalized-cache"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="apollo-kotlin-normalized-cache Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/partial-cache-reads.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Partial cache reads | apollo-kotlin-normalized-cache"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/partial-cache-reads.html#webpage",
    "url": "writerside-documentation/partial-cache-reads.html",
    "name": "Partial cache reads | apollo-kotlin-normalized-cache",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "apollo-kotlin-normalized-cache Help"
}</script><!-- End Schema.org --></head><body data-id="partial-cache-reads" data-main-title="Partial cache reads" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="" data-edit-url="https://github.com/apollographql/apollo-kotlin-normalized-cache/edit/main/Writerside/topics/partial-cache-reads.md"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>apollo-kotlin-normalized-cache  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="partial-cache-reads" id="partial-cache-reads.md">Partial cache reads</h1><p id="-n4o3ay_3">The cache supports partial cache reads, in a similar way to how GraphQL supports partial responses. This means that if some fields are missing from the cache, the cache will return the available data along with any errors for the missing fields.</p><section class="chapter"><h2 id="with-apollostore" data-toc="with-apollostore">With <code class="code" id="-n4o3ay_11">ApolloStore</code></h2><p id="-n4o3ay_8">The <a href="https://apollographql.github.io/apollo-kotlin-normalized-cache/kdoc/normalized-cache/com.apollographql.cache.normalized/-apollo-store/read-operation.html" id="-n4o3ay_12" data-external="true" rel="noopener noreferrer"><code class="code" id="-n4o3ay_16">ApolloStore.readOperation()</code></a> API returns an <code class="code" id="-n4o3ay_13">ApolloResponse&lt;D&gt;</code> that can contain partial <code class="code" id="-n4o3ay_14">data</code> and non-empty <code class="code" id="-n4o3ay_15">errors</code> for any missing (or stale) fields in the cache.</p><aside class="prompt" data-type="tip" data-title="" id="-n4o3ay_9"><p id="-n4o3ay_17"><code class="code" id="-n4o3ay_18">ApolloResponse.cacheInfo.isCacheHit</code> will be false when any field is missing. <code class="code" id="-n4o3ay_19">ApolloResponse.cacheInfo.isStale</code> will be true when any field is stale.</p></aside><p id="-n4o3ay_10">If a cache miss exception is preferred, you can use the <code class="code" id="-n4o3ay_20">ApolloResponse&lt;D&gt;.errorsAsException()</code> extension function that returns a response with an exception if there are any errors.</p></section><section class="chapter"><h2 id="with-apolloclient" data-toc="with-apolloclient">With <code class="code" id="-n4o3ay_25">ApolloClient</code></h2><p id="-n4o3ay_22">When executing operations, the built-in fetch policies (<a href="https://apollographql.github.io/apollo-kotlin-normalized-cache/kdoc/normalized-cache/com.apollographql.cache.normalized/-fetch-policy/-cache-first/index.html?query=CacheFirst" id="-n4o3ay_26" data-external="true" rel="noopener noreferrer"><code class="code" id="-n4o3ay_28">FetchPolicy.CacheFirst</code></a>, <a href="https://apollographql.github.io/apollo-kotlin-normalized-cache/kdoc/normalized-cache/com.apollographql.cache.normalized/-fetch-policy/-cache-only/index.html" id="-n4o3ay_27" data-external="true" rel="noopener noreferrer"><code class="code" id="-n4o3ay_29">FetchPolicy.CacheOnly</code></a>, etc.) will treat cache misses as exceptions (partial results are disabled).</p><p id="-n4o3ay_23">To benefit from partial cache reads, implement your own fetch policy interceptor as shown in this example:</p><div class="code-block" data-lang="kotlin">
object PartialCacheOnlyInterceptor : ApolloInterceptor {
  override fun &lt;D : Operation.Data&gt; intercept(
      request: ApolloRequest&lt;D&gt;, 
      chain: ApolloInterceptorChain
  ): Flow&lt;ApolloResponse&lt;D&gt;&gt; {
    return chain.proceed(
        request = request
            .newBuilder()
            // Controls where to read the data from (cache or network)
            .fetchFromCache(true)
            .build()
    )
  }
}

// ...

val apolloClient = ApolloClient.Builder()
    /*...*/
    .serverUrl(&quot;https://example.com/graphql&quot;)
    .fetchPolicyInterceptor(PartialCacheOnlyInterceptor)
    .build()
</div></section><section class="chapter"><h2 id="error-stored-in-the-cache" data-toc="error-stored-in-the-cache">Error stored in the cache</h2><p id="-n4o3ay_30">Errors from the server are stored in the cache, and will be returned when reading it.</p><p id="-n4o3ay_31">By default, errors don't replace existing data in the cache. You can change this behavior with <a href="https://apollographql.github.io/apollo-kotlin-normalized-cache/kdoc/normalized-cache/com.apollographql.cache.normalized/errors-replace-cached-values.html?query=fun%20%3CT%3E%20MutableExecutionOptions%3CT%3E.errorsReplaceCachedValues(errorsReplaceCachedValues:%20Boolean):%20T" id="-n4o3ay_32" data-external="true" rel="noopener noreferrer"><code class="code" id="-n4o3ay_33">errorsReplaceCachedValues(true)</code></a>.</p></section><div class="last-modified">Last modified: 30 June 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="trimming.html" class="navigation-links__prev">Trimming the cache</a><a href="compiler-plugin.html" class="navigation-links__next">Compiler plugin</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b575/app.js"></script></body></html>